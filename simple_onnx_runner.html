<!DOCTYPE html>
<html>
<head>
  <title>Simple ONNX Model Runner</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    #output {
      background-color: #f5f5f5;
      border: 1px solid #ddd;
      padding: 10px;
      margin-top: 20px;
      white-space: pre-wrap;
      font-family: monospace;
    }
    button {
      padding: 8px 16px;
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
      margin-top: 10px;
    }
    .error { color: red; }
    .success { color: green; }
  </style>
</head>
<body>
  <h1>Simple ONNX Model Runner</h1>
  <p>This page loads and runs the actor.onnx model from the MARL 2vs2 Soccer project.</p>
  
  <button id="runBtn">Run Model</button>
  <div id="output">Results will appear here...</div>

  <!-- Load ONNX Runtime Web from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js"></script>
  
  <script>
    // Get DOM elements
    const outputDiv = document.getElementById('output');
    const runBtn = document.getElementById('runBtn');
    
    // Log message to output div
    function log(message, isError = false, isSuccess = false) {
      const div = document.createElement('div');
      if (isError) div.className = 'error';
      if (isSuccess) div.className = 'success';
      div.textContent = message;
      outputDiv.appendChild(div);
      console.log(message);
    }
    
    // Clear output
    function clearOutput() {
      outputDiv.innerHTML = '';
    }
    
    // Create input data with random values
    function createInput() {
      const inputData = new Float32Array(20);
      for (let i = 0; i < 20; i++) {
        inputData[i] = Math.random() * 2 - 1; // Random values between -1 and 1
      }
      return inputData;
    }
    
    // Run the model
    async function runModel() {
      clearOutput();
      log('Loading and running model...');
      
      try {
        // Create session
        const session = await ort.InferenceSession.create('models/actor1.onnx');
        
        // Create input tensor
        const inputData = createInput();
        const tensor = new ort.Tensor('float32', inputData, [1, 20]);
        
        // Get input name from model and create feeds object
        const feeds = {};
        feeds[session.inputNames[0]] = tensor;
        
        // Run inference
        const results = await session.run(feeds);
        
        // Output results
        log('Model executed successfully!', false, true);
        log('Input values: ' + Array.from(inputData).slice(0, 5).join(', ') + '...');
        
        // Display each output tensor
        for (const [outputName, tensor] of Object.entries(results)) {
          log(`Output "${outputName}":`);
          const data = Array.from(tensor.data);
          
          // Format output data
          let outputStr = `Shape: [${tensor.dims.join(', ')}]\nValues: `;
          if (data.length <= 20) {
            outputStr += JSON.stringify(data);
          } else {
            outputStr += JSON.stringify(data.slice(0, 20)) + '... (truncated)';
          }
          
          log(outputStr);
        }
        
      } catch (error) {
        log('Error: ' + error.message, true);
        
        // Add hint for file access errors
        if (error.message.includes('Access-Control-Allow-Origin') || 
            error.message.includes('Cross-Origin') || 
            error.message.includes('file://')) {
          log('This is likely a browser security restriction when loading local files.', true);
          log('Try opening Chrome with --allow-file-access-from-files flag or use a local web server.', false);
        }
        
        console.error(error);
      }
    }
    
    // Add event listener to button
    runBtn.addEventListener('click', runModel);
    
    // Initial log
    log('Click "Run Model" to execute the ONNX model');
  </script>
</body>
</html> 